---
date: 2024-10-28 7:00:00
categories:
  - ctf
  - reverse engineering
title: Deadface 2024 CTF
tags:
  - forensics
  - reverseengineering
  - deadface
---
This is a writeup for  DeadFace ctf 2024

![pic1.png](/assets/posts/deadface2024/pic1.png)



## Reverse Engineering
## Cereal Killer 01

![pic1.png](/assets/posts/deadface2024/pic2.png)

We are given a binary and an executable file.  Running the executable we are prompted for a password I loaded up the binary file in IDA Pro and looked at the strings maybe the password is hardcoded lets see! 
![pic1.png](/assets/posts/deadface2024/pic3.png)The string `obboreel` stands out trying it out as the password and it was not the password.
I did spin up x64dbg to debug the file and set a breakpoint before the jump of printing the bad message Access Denied.

![pic1.png](/assets/posts/deadface2024/pic4.png)


After 

![pic1.png](/assets/posts/deadface2024/pic5.png)

The input is being reversed the word `booberry` looking up the word its a cereal and trying it out it was definetly the  password and we get the flag!

![pic1.png](/assets/posts/deadface2024/pic6.png)


## Cereal Killer 02

![pic1.png](/assets/posts/deadface2024/pic7.png)

Running the binary gave me the cryptic message, “Please enter the password.” Challenge accepted.
I tossed this bad boy into IDA Pro, and right away, I zeroed in on the function `sub_13DC`. The name didn’t scream “password handler,” but it was clearly doing _something_ important. A few strings in the output hinted it might be a password validation function, so let’s crack it wide open.

![pic1.png](/assets/posts/deadface2024/pic9.png)

### `sub_13DC` – The Password Sieve

So, we’ve got a big ol' pile of variables in here—`s`, `s1`, `s2`, and some more arrays. This is where the binary initializes everything, probably hashing or messing with the password input in some convoluted way. Here’s the fun part:

1. **The Password Prompt**: The function prompts for the password, which gets shoved into `inputpassword`. Right after, a string of mysterious sub-functions start grinding away at the input. This was a clear invitation to reverse engineer each one.
    
2. **Breaking Down the Mystery Functions**: First up, `sub_132F`. This function takes a string like `"976e86dafec99d2da69bbaa762aba8cc"` and stores some hashed result into `s2`. It was hashing hardcoded strings, which meant the binary was expecting something specific to pass that check 
3. So, after finding the password _yellowschoolbus_  using the hash `104e5dc03561ebf96acf9a0b2b5f184f` online, I confidently punched it into the binary. But guess what? It didn’t work! Classic case of getting your hopes up, right?

Then I spotted that sneaky second hash, `976e86dafec99d2da69bbaa762aba8cc`. I knew that one was going to need some serious firepower, likely requiring Hashcat to crack it.

 Instead, I opted to patch the program. I mean, who wouldn’t choose a shortcut when the end goal is just a patch away? So, I skipped the hassle of cracking that second hash, and just like that, I was ready to snag the flag without any fuss!
![pic1.png](/assets/posts/deadface2024/pic10.png)


To really wrap things up, I decided to NOP (No Operation) the `JNE` instruction in the binary. 


![pic1.png](/assets/posts/deadface2024/pic8.png)


## Cereal Killer 03

![pic11.png](/assets/posts/deadface2024/pic11.png)
*We’ve conquered the 250-point challenges, and now it's time to gear up for the big leagues as we tackle the 500-point ones!*


When analyzing the pseudocode we see the password is being hashed inspecting the memory layout I did set a breakpoint before  jump is taken the `cmp eax, [ecx]`  synchronizing the `ecx` variable with the hex view we can see our input password `stephen` is md5 hashed` 7F F3 67 97 53 91 30 F7 74 45 F4 8D A5 D4 A1 26`

![pic12.png](/assets/posts/deadface2024/pic12.png)The correct password being saved in the `edx` register I synchronized it as well and it sits on top of the `ecx` register `EC C8 8B 0A F9 02 53 E8 70 06 97 4B 2F 3F DC `


I did assemble the `edx` bytes to the `ecx` to make a match for the comparison to pass 

![pic15.png](/assets/posts/deadface2024/pic15.png)

Running the executable after setting a breakpoint before `retn` to get the flag 
![pic13.png](/assets/posts/deadface2024/pic13.png)



